DROP TABLE TBL_VENTAS;

CREATE TABLE TBL_VENTAS (
    CODIGO_VENTA NUMBER PRIMARY KEY,
    CODIGO_CLIENTE NUMBER,
    CODIGO_PRODUCTO NUMBER,
    FECHA_VENTA DATE,
    CANTIDAD NUMBER,
    PRECIO NUMBER,
    TOTAL NUMBER
);


TRUNCATE TABLE TBL_VENTAS;
CREATE SEQUENCE SEQ_VENTAS;
DECLARE
    V_FECHA_INICIO DATE := SYSDATE-365;
    V_FECHA_FIN DATE := SYSDATE;
    V_CANTIDAD NUMBER;
    V_PRECIO NUMBER;
BEGIN
    WHILE (V_FECHA_INICIO <= V_FECHA_FIN) LOOP
        FOR I IN 1..20 LOOP
            V_CANTIDAD := ROUND(DBMS_RANDOM.VALUE(1, 100));
            V_PRECIO := ROUND(DBMS_RANDOM.VALUE(1, 2000));
            INSERT INTO TBL_VENTAS
            (CODIGO_VENTA,
                CODIGO_CLIENTE,
                CODIGO_PRODUCTO,
                FECHA_VENTA,
                CANTIDAD,
                PRECIO,
                TOTAL
            ) VALUES (
                SEQ_VENTAS.NEXTVAL,
                ROUND(DBMS_RANDOM.VALUE(1, 100)),
                ROUND(DBMS_RANDOM.VALUE(1, 100)),
                V_FECHA_INICIO,
                V_CANTIDAD,
                V_PRECIO,
                V_CANTIDAD * V_PRECIO
            );
        END LOOP;
        V_FECHA_INICIO := V_FECHA_INICIO + 1;
    END LOOP;
    COMMIT;
END;

TRUNCATE TABLE TBL_VENTAS;

SELECT FECHA_VENTA, COUNT(*) 
FROM TBL_VENTAS
GROUP BY FECHA_VENTA;

SELECT COUNT(*) FROM TBL_VENTAS;

SELECT DBMS_RANDOM.VALUE(1,100) FROM DUAL;